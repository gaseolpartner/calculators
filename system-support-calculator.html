<!DOCTYPE html>
<!--
==============================================================
                     âš ï¸ ì¤‘ìš” ê²½ê³  âš ï¸
==============================================================
íŒŒì¼ëª…: ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ê³„ì‚°ê¸°.html

ì´ íŒŒì¼ì˜ íŒŒì¼ëª…ê³¼ ë‚´ìš©ì„ ë³€ê²½í•˜ì§€ ë§ˆì‹­ì‹œì˜¤.
ë³¸ í”„ë¡œê·¸ë¨ì€ ì €ì‘ê¶Œë²•ì— ì˜í•´ ë³´í˜¸ë˜ê³  ìˆìŠµë‹ˆë‹¤.

Â© 2025 ê°€ì„¤íŒŒíŠ¸ë„ˆ. All rights reserved.

ë¬´ë‹¨ ë³µì œ, ìˆ˜ì •, ë°°í¬ ì‹œ ë²•ì  ì²˜ë²Œì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë¬¸ì˜: 010-7970-2108 | fc112@naver.com
==============================================================
-->
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ê°€ì„¤íŒŒíŠ¸ë„ˆ - ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ê³„ì‚°ê¸° v1.0">
    <meta name="author" content="ê°€ì„¤íŒŒíŠ¸ë„ˆ">
    <meta name="keywords" content="ì‹œìŠ¤í…œë™ë°”ë¦¬, ì„œí¬íŠ¸, ë¬¼ëŸ‰ì‚°ì¶œ, ê±´ì„¤, ê°€ì„¤êµ¬ì¡°ë¬¼">
    <meta name="copyright" content="Â© 2025 ê°€ì„¤íŒŒíŠ¸ë„ˆ. All rights reserved.">
    <meta name="generator" content="ê°€ì„¤íŒŒíŠ¸ë„ˆ ì‹œìŠ¤í…œ ë™ë°”ë¦¬ v1.0">
    <meta name="application-name" content="ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ê³„ì‚°ê¸°">
    <meta name="msapplication-tooltip" content="ê°€ì„¤íŒŒíŠ¸ë„ˆ ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ê³„ì‚°ê¸°">
    <meta name="msapplication-TileColor" content="#2a5298">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ê³„ì‚°ê¸° v1.0 - ê°€ì„¤íŒŒíŠ¸ë„ˆ</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-K8NMSLZ841"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-K8NMSLZ841');
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            /* ë“œë˜ê·¸ ë°©ì§€ */
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
        }
        
        /* ì…ë ¥ í•„ë“œëŠ” ì„ íƒ ê°€ëŠ¥í•˜ê²Œ */
        input, textarea {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
        
        body {
            font-family: 'Malgun Gothic', 'Noto Sans KR', sans-serif;
            background: #1a1a1a;
            color: #fff;
            overflow-x: hidden;
            /* ì´ë¯¸ì§€ ë° ìš”ì†Œ ë³´í˜¸ */
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* ì›Œí„°ë§ˆí¬ */
        body::before {
            content: "Â© 2025 ê°€ì„¤íŒŒíŠ¸ë„ˆ";
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 120px;
            color: rgba(255, 255, 255, 0.02);
            z-index: -1;
            pointer-events: none;
            white-space: nowrap;
        }
        
        /* ìƒë‹¨ í—¤ë” */
        .company-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }
        
        .company-header::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            bottom: -50%;
            left: -50%;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .company-name {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            position: relative;
            z-index: 1;
        }
        
        .program-title {
            font-size: 20px;
            color: #fff;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        /* ë²•ì  ê³µì§€ */
        .legal-notice {
            background: #ffeeee;
            border: 2px solid #ff4444;
            padding: 15px;
            margin: 20px;
            border-radius: 5px;
            color: #aa0000;
            font-weight: bold;
            text-align: center;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ì…ë ¥ ì„¹ì…˜ */
        .input-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .section-title {
            color: #1e3c72;
            font-size: 24px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #2a5298;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: block;
            color: #555;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fff;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }
        
        select.input-field {
            cursor: pointer;
        }
        
        /* êµ¬ì¡° íƒ€ì… ì„ íƒ */
        .structure-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .structure-type-card {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .structure-type-card h3 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #2a5298;
        }
        
        .structure-type-card p {
            font-size: 14px;
            opacity: 0.8;
            color: #2a5298;
        }
        
        .structure-type-card:hover {
            border-color: #2a5298;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(42, 82, 152, 0.2);
        }
        
        .structure-type-card.active {
            background: #2a5298;
            color: white;
            border-color: #2a5298;
        }
        
        .structure-type-card.active h3,
        .structure-type-card.active p {
            color: white;
        }
        
        /* ì•ˆì „ìœ¨ ìŠ¬ë¼ì´ë” */
        .safety-rate-container {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .slider {
            flex: 1;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 5px;
            background: #e0e0e0;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #2a5298;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #2a5298;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .slider-value {
            min-width: 80px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            color: #2a5298;
        }
        
        /* ê³„ì‚° ë²„íŠ¼ */
        .calculate-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .calculate-button::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .calculate-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(42, 82, 152, 0.3);
        }
        
        /* ê²°ê³¼ ì„¹ì…˜ */
        .result-section {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .result-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .result-header {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .result-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .result-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #2a5298;
        }
        
        .result-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .result-value {
            color: #2a5298;
            font-size: 32px;
            font-weight: bold;
        }
        
        .result-unit {
            color: #888;
            font-size: 16px;
            margin-left: 5px;
        }
        
        /* ìƒì„¸ í…Œì´ë¸” */
        .detail-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
        }
        
        .detail-table th {
            background: #2a5298;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: white;
            border-bottom: 2px solid #1e3c72;
        }
        
        .detail-table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
            color: #333;
        }
        
        .detail-table tr:hover {
            background: #f0f4ff;
        }
        
        .detail-table td[colspan] {
            background: #e8f0ff;
            font-weight: bold;
            color: #1e3c72;
        }
        
        /* ë‹¨ê°€ ì…ë ¥ ì„¹ì…˜ */
        .price-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
        }
        
        .price-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .price-header h3 {
            color: #1e3c72;
            font-size: 20px;
        }
        
        .price-header-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .toggle-price-btn, .price-action-btn {
            background: #2a5298;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
        }
        
        .toggle-price-btn:hover, .price-action-btn:hover {
            background: #1e3c72;
        }
        
        .price-input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            background: #f0f4f8;
            border-radius: 8px;
        }
        
        .price-input-item {
            display: grid;
            grid-template-columns: minmax(120px, 1.5fr) 1fr 1fr;
            gap: 5px;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
            font-size: 13px;
        }
        
        .price-input-item label {
            font-size: 12px;
            color: #555;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .price-input-item input {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            text-align: right;
            width: 100%;
        }
        
        .usage-days-container {
            background: #e8f0ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .usage-days-container label {
            color: #1e3c72;
            font-weight: bold;
        }
        
        .usage-days-container input {
            width: 80px;
            padding: 6px;
            border: 2px solid #2a5298;
            border-radius: 5px;
            font-size: 14px;
            text-align: center;
        }
        
        /* ë°ì´í„° ì·¨í•© ì„¹ì…˜ */
        .combine-section {
            background: #f0f8ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            border: 2px solid #4169e1;
        }
        
        .combine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .combine-header h3 {
            color: #1e3c72;
            font-size: 20px;
        }
        
        .saved-data-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .saved-data-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .saved-data-item:hover {
            border-color: #2a5298;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .saved-data-item.selected {
            border-color: #2a5298;
            background: #e8f0ff;
        }
        
        .saved-data-item h4 {
            color: #1e3c72;
            margin-bottom: 5px;
        }
        
        .saved-data-item p {
            font-size: 13px;
            color: #666;
            margin: 2px 0;
        }
        
        /* ìš”ì•½ ì •ë³´ */
        .summary-box {
            background: linear-gradient(135deg, #f6f9fc 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 12px;
            margin-top: 25px;
            border: 1px solid #dee2e6;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            text-align: center;
        }
        
        .summary-item {
            padding: 15px;
        }
        
        .summary-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .summary-value {
            color: #1e3c72;
            font-size: 24px;
            font-weight: bold;
        }
        
        /* ë²•ì  ê³ ì§€ ë°•ìŠ¤ */
        .legal-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
        }
        
        .legal-warning h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .legal-warning p {
            color: #856404;
            line-height: 1.6;
        }
        
        /* ë²„íŠ¼ ê·¸ë£¹ */
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .button-primary {
            background: #2a5298;
            color: white;
        }
        
        .button-primary:hover {
            background: #1e3c72;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 82, 152, 0.3);
        }
        
        .button-secondary {
            background: #6c757d;
            color: white;
        }
        
        .button-secondary:hover {
            background: #5a6268;
        }
        
        .button-success {
            background: #28a745;
            color: white;
        }
        
        .button-success:hover {
            background: #218838;
        }
        
        /* í•˜ë‹¨ ì •ë³´ */
        .footer-info {
            background: #222;
            color: #aaa;
            padding: 40px 20px;
            text-align: center;
            margin-top: 60px;
        }
        
        .footer-info h3 {
            color: #fff;
            margin-bottom: 20px;
        }
        
        .footer-info p {
            margin: 10px 0;
            line-height: 1.6;
        }
        
        .footer-info a {
            color: #2a5298;
            text-decoration: none;
        }
        
        .footer-info a:hover {
            color: #4169e1;
            text-decoration: underline;
        }
        
        .copyright {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid #444;
            font-size: 14px;
            color: #888;
        }
        
        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalShow 0.3s ease-out;
        }
        
        @keyframes modalShow {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .modal-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .modal-title {
            font-size: 24px;
            color: #1e3c72;
            margin: 0;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 28px;
            color: #999;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-modal:hover {
            color: #333;
        }
        
        /* ì¸ì‡„ ìŠ¤íƒ€ì¼ */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .no-print {
                display: none !important;
            }
            
            .result-card {
                page-break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .company-name {
                font-size: 24px;
            }
            
            .program-title {
                font-size: 16px;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
            
            .structure-types {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .button {
                width: 100%;
            }
        }
        
        /* ë””ë²„ê·¸ ì •ë³´ í‘œì‹œìš© */
        .debug-info {
            background: #f0f0f0;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #333;
        }
        
        .debug-info h4 {
            color: #1e3c72;
            margin-bottom: 10px;
        }
        
        .debug-info pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body oncontextmenu="return false" ondragstart="return false" onselectstart="return false">
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="company-header">
        <h1 class="company-name">ê°€ì„¤íŒŒíŠ¸ë„ˆ</h1>
        <p class="program-title">ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ê³„ì‚°ê¸° v1.0</p>
    </div>
    
    <!-- ë²•ì  ê³µì§€ -->
    <div class="legal-notice">
        âš ï¸ ë³¸ í”„ë¡œê·¸ë¨ì€ ì°¸ê³ ìš© ë¬¼ëŸ‰ ì‚°ì¶œ í”„ë¡œê·¸ë¨ì…ë‹ˆë‹¤. ì •í™•í•œ ì‹¤ ìˆ˜ëŸ‰ì€ ë°°ì¹˜ ë„ë©´ì„ ì°¸ê³ í•˜ì—¬ ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
    </div>
    
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="main-container">
        <!-- ì…ë ¥ ì„¹ì…˜ -->
        <div class="input-section">
            <h2 class="section-title">ğŸ—ï¸ ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ì„¤ì¹˜ ì •ë³´ ì…ë ¥</h2>
            
            <!-- êµ¬ì¡° íƒ€ì… ì„ íƒ -->
            <div class="structure-types">
                <div class="structure-type-card active" onclick="selectStructureType('wall', this)">
                    <h3>ë²½ì‹êµ¬ì¡°</h3>
                    <p>ì¼ë°˜ ì•„íŒŒíŠ¸, ì£¼ìƒë³µí•©</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('truss', this)">
                    <h3>íŠ¸ëŸ¬ìŠ¤êµ¬ì¡°</h3>
                    <p>ëŒ€ê³µê°„ êµ¬ì¡°ë¬¼</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('beam', this)">
                    <h3>ë‹¨ë…ë³´êµ¬ì¡°</h3>
                    <p>ë³´ ë‹¨ë… ì‹œê³µ</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('tg', this)">
                    <h3>TGë³´êµ¬ì¡°</h3>
                    <p>Transfer Girder</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('tp', this)">
                    <h3>TPêµ¬ì¡°</h3>
                    <p>Transfer Plate</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('ramp', this)">
                    <h3>RAMP</h3>
                    <p>ê²½ì‚¬ë¡œ êµ¬ì¡°</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('deck', this)">
                    <h3>DECK</h3>
                    <p>ë°í¬í”Œë ˆì´íŠ¸</p>
                </div>
                <div class="structure-type-card" onclick="selectStructureType('deck900', this)">
                    <h3>DECK+900</h3>
                    <p>ë†’ì€ ë°í¬í”Œë ˆì´íŠ¸</p>
                </div>
            </div>
            
            <!-- ê¸°ë³¸ ì…ë ¥ ì •ë³´ -->
            <div class="input-grid">
                <div class="input-group">
                    <label class="input-label" for="volume">ê³µë£¨ë²  (ã¥)</label>
                    <input type="number" class="input-field" id="volume" value="100" step="0.1" min="0">
                </div>
                <div class="input-group">
                    <label class="input-label" for="height">ì¸µê³  (mm)</label>
                    <input type="number" class="input-field" id="height" value="5000" step="100" min="2000" max="10000">
                </div>
                <div class="input-group">
                    <label class="input-label" for="slabThk">ìŠ¬ë¼ë¸Œ ë‘ê»˜ (mm)</label>
                    <input type="number" class="input-field" id="slabThk" value="200" step="10" min="100" max="500">
                </div>
                <div class="input-group">
                    <label class="input-label" for="beamThk">ë³´ ë‘ê»˜ (mm)</label>
                    <input type="number" class="input-field" id="beamThk" value="0" step="50" min="0" max="2000">
                </div>
            </div>
            
            <!-- ì•ˆì „ìœ¨ ì„¤ì • -->
            <div class="safety-rate-container">
                <label class="input-label">ì•ˆì „ìœ¨ ì„¤ì • (%)</label>
                <div class="slider-container">
                    <input type="range" class="slider" id="safetyRate" min="0" max="15" value="0" step="1">
                    <div class="slider-value"><span id="safetyRateDisplay">0</span>%</div>
                </div>
                <p style="margin-top: 10px; color: #666; font-size: 14px;">
                    * í˜„ì¥ ì—¬ê±´ì— ë”°ë¼ 1~15% ë²”ìœ„ì—ì„œ ì¡°ì • ê°€ëŠ¥í•©ë‹ˆë‹¤. ì‹¤ì œ í˜„ì¥ ì¡°ê±´ì— ë”°ë¼ ë°ì´í„°ê°€ ìƒì´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>
            
            <!-- ê³„ì‚° ë²„íŠ¼ -->
            <button class="calculate-button" onclick="calculateQuantity()">
                ë¬¼ëŸ‰ ê³„ì‚°í•˜ê¸°
            </button>
        </div>
        
        <!-- ê²°ê³¼ ì„¹ì…˜ -->
        <div class="result-section" id="resultSection">
            <div class="result-card">
                <div class="result-header">
                    <h2 class="result-title">ğŸ“Š ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ì‚°ì¶œ ê²°ê³¼</h2>
                    <p id="resultInfo" style="margin-top: 10px;"></p>
                </div>
                
                <!-- ì£¼ìš” ìì¬ ìˆ˜ëŸ‰ -->
                <div class="result-grid">
                    <div class="result-item">
                        <div class="result-label">ìˆ˜ì§ì¬ (Vertical)</div>
                        <div>
                            <span class="result-value" id="verticalCount">0</span>
                            <span class="result-unit">ê°œ</span>
                        </div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">ìˆ˜í‰ì¬ (Horizontal)</div>
                        <div>
                            <span class="result-value" id="horizontalCount">0</span>
                            <span class="result-unit">ê°œ</span>
                        </div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">U-í—¤ë“œì­</div>
                        <div>
                            <span class="result-value" id="uheadCount">0</span>
                            <span class="result-unit">ê°œ</span>
                        </div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">ë² ì´ìŠ¤ì­</div>
                        <div>
                            <span class="result-value" id="baseCount">0</span>
                            <span class="result-unit">ê°œ</span>
                        </div>
                    </div>
                </div>
                
                <!-- ë‹¨ê°€ ì…ë ¥ ì„¹ì…˜ -->
                <div class="price-section">
                    <div class="price-header">
                        <h3>ğŸ’° ìì¬ ë‹¨ê°€ ì…ë ¥</h3>
                        <div class="price-header-buttons">
                            <button class="toggle-price-btn" onclick="togglePriceSection()">ë‹¨ê°€ ì…ë ¥</button>
                            <button class="price-action-btn" onclick="savePriceData()">ë‹¨ê°€ ì €ì¥</button>
                            <button class="price-action-btn" onclick="loadPriceData()">ë‹¨ê°€ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                            <button class="price-action-btn" onclick="exportPriceToExcel()" style="background: #28a745;">ğŸ“¥ ì—‘ì…€ ë‚´ë³´ë‚´ê¸°</button>
                            <button class="price-action-btn" onclick="document.getElementById('priceFileInput').click()" style="background: #17a2b8;">ğŸ“¤ ì—‘ì…€ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                            <input type="file" id="priceFileInput" accept=".csv" style="display:none;" onchange="importPriceFromExcel(event)">
                        </div>
                    </div>
                    
                    <div id="priceInputContainer" style="display: none;">
                        <div class="usage-days-container">
                            <label for="usageDays">ì‚¬ìš© ì¼ìˆ˜:</label>
                            <input type="number" id="usageDays" value="30" min="1" max="365">ì¼
                            <button class="button button-primary" onclick="calculatePrice()" style="margin-left: auto;">
                                ê¸ˆì•¡ ê³„ì‚°í•˜ê¸°
                            </button>
                        </div>
                        
                        <div class="price-input-grid" id="priceInputGrid">
                            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                        </div>
                    </div>
                </div>
                
                <!-- ë°ì´í„° ì·¨í•© ì„¹ì…˜ -->
                <div class="combine-section" id="combineSection" style="display: none;">
                    <div class="combine-header">
                        <h3>ğŸ“Š ë°ì´í„° ì·¨í•©</h3>
                        <button class="button button-primary" onclick="combineData()">
                            ì„ íƒí•œ ë°ì´í„° ì·¨í•©í•˜ê¸°
                        </button>
                    </div>
                    
                    <div class="saved-data-list" id="savedDataList">
                        <!-- ì €ì¥ëœ ë°ì´í„° ëª©ë¡ í‘œì‹œ -->
                    </div>
                </div>
                
                <!-- ìƒì„¸ ìˆ˜ëŸ‰ í…Œì´ë¸” -->
                <h3 style="margin-top: 40px; margin-bottom: 20px; color: #1e3c72; font-size: 20px;">ğŸ“‹ ìƒì„¸ ìì¬ ìˆ˜ëŸ‰</h3>
                <table class="detail-table">
                    <thead>
                        <tr>
                            <th>í’ˆëª…</th>
                            <th>ê·œê²©</th>
                            <th>ìˆ˜ëŸ‰</th>
                            <th>ë‹¨ìœ„ì¤‘ëŸ‰(kg)</th>
                            <th>ì´ì¤‘ëŸ‰(kg)</th>
                            <th class="price-column" style="display: none;">ê¸°ë³¸ë£Œ(ì›)</th>
                            <th class="price-column" style="display: none;">ì¼ë‹¨ê°€(ì›)</th>
                            <th class="price-column" style="display: none;">ì´ê¸ˆì•¡(ì›)</th>
                        </tr>
                    </thead>
                    <tbody id="detailTableBody">
                        <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
                    </tbody>
                </table>
                
                <!-- ìš”ì•½ ì •ë³´ -->
                <div class="summary-box">
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-label">ì„¤ì¹˜ ì²´ì </div>
                            <div class="summary-value" id="totalVolume">-</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-label">ì‹¤ì‘ì—… ë†’ì´</div>
                            <div class="summary-value" id="workHeight">-</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-label">ì´ ì¤‘ëŸ‰</div>
                            <div class="summary-value" id="totalWeight">-</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-label">ã¥ë‹¹ ì¤‘ëŸ‰</div>
                            <div class="summary-value" id="weightPerM3">-</div>
                        </div>
                        <div class="summary-item price-summary" style="display: none;">
                            <div class="summary-label">ì´ ìì¬ë¹„</div>
                            <div class="summary-value" id="totalPrice">-</div>
                        </div>
                        <div class="summary-item price-summary" style="display: none;">
                            <div class="summary-label">ã¥ë‹¹ ë‹¨ê°€</div>
                            <div class="summary-value" id="pricePerM3">-</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 15px; background: #f0f4ff; border-radius: 8px;">
                        <p style="color: #1e3c72; font-size: 14px; margin: 0;">
                            <strong>ì‹¤ì‘ì—… ë†’ì´ ê³„ì‚°ì‹:</strong><br>
                            ì‹¤ì‘ì—… ë†’ì´ = ì¸µê³  - ìŠ¬ë¼ë¸Œ ë‘ê»˜ - ë³´ ë‘ê»˜ - ë©ì—ì¬(125mm) - í—¤ë“œë² ì´ìŠ¤(300mm) - ì­ë² ì´ìŠ¤(300mm) - ì†Œì¼“(120mm) - í•©íŒ(12mm) - ì¥ì„ (50mm)
                        </p>
                    </div>
                </div>
                
                <!-- ë²•ì  ê³ ì§€ -->
                <div class="legal-warning">
                    <h3>âš ï¸ ì¤‘ìš” ì•ˆë‚´ì‚¬í•­</h3>
                    <p>
                        ë³¸ ê³„ì‚° ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ í˜„ì¥ ì¡°ê±´ì— ë”°ë¼ ìˆ˜ëŸ‰ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                        ì •í™•í•œ ì‹¤ ìˆ˜ëŸ‰ì€ ë°°ì¹˜ ë„ë©´ì„ ì°¸ê³ í•˜ì—¬ ì‚¬ìš©í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.<br>
                        <strong style="color: #ff0000;">ë³¸ í”„ë¡œê·¸ë¨ì€ ê²¬ì ì‹œ ì°¸ê³ ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ì‹œê³  ì‹¤ìˆ˜ëŸ‰ìœ¼ë¡œ ì‚¬ìš©í•¨ì— ì±…ì„ì´ ì—†ìŠµë‹ˆë‹¤.</strong>
                    </p>
                </div>
                
                <!-- ë²„íŠ¼ ê·¸ë£¹ -->
                <div class="button-group">
                    <button class="button button-primary no-print" onclick="window.print()">
                        ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°
                    </button>
                    <button class="button button-primary no-print" onclick="generateQuotation()">
                        ğŸ“„ ê²¬ì ì„œ ìƒì„±
                    </button>
                    <button class="button button-success no-print" onclick="exportToExcel()">
                        ğŸ“Š ì—‘ì…€ ë‚´ë³´ë‚´ê¸°
                    </button>
                    <button class="button button-success no-print" onclick="saveCurrentCalculation()">
                        ğŸ’¾ í˜„ì¬ ê²°ê³¼ ì €ì¥
                    </button>
                    <button class="button button-secondary no-print" onclick="resetCalculator()">
                        ğŸ”„ ì´ˆê¸°í™”
                    </button>
                </div>
                
                <!-- ë‹¤ì¤‘ êµ¬ê°„ ê²¬ì  ì„¹ì…˜ -->
                <div class="multi-section-container no-print" style="margin-top: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 25px; color: white;">
                    <h3 style="margin-bottom: 20px; font-size: 20px;">ğŸ“‹ ë‹¤ì¤‘ êµ¬ê°„ í†µí•© ê²¬ì </h3>
                    <p style="margin-bottom: 15px; opacity: 0.9; font-size: 14px;">
                        ì—¬ëŸ¬ êµ¬ê°„(ë°í¬, RC, ë³´ ë“±)ì„ ê°ê° ê³„ì‚° í›„ ì €ì¥í•˜ê³ , í•œ ë²ˆì— í†µí•© ê²¬ì ì„œë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    
                    <div class="button-group" style="margin-bottom: 20px;">
                        <button class="button" onclick="addToQuotationList()" style="background: #28a745; border: none;">
                            â• í˜„ì¬ êµ¬ê°„ ê²¬ì ì— ì¶”ê°€
                        </button>
                        <button class="button" onclick="showQuotationList()" style="background: #17a2b8; border: none;">
                            ğŸ“‹ ì €ì¥ëœ êµ¬ê°„ ë³´ê¸° (<span id="quotationCount">0</span>ê°œ)
                        </button>
                        <button class="button" onclick="generateCombinedQuotation()" style="background: #ffc107; color: #333; border: none;">
                            ğŸ“„ í†µí•© ê²¬ì ì„œ ìƒì„±
                        </button>
                        <button class="button" onclick="clearQuotationList()" style="background: #dc3545; border: none;">
                            ğŸ—‘ï¸ êµ¬ê°„ ëª©ë¡ ì´ˆê¸°í™”
                        </button>
                    </div>
                    
                    <div id="quotationListPreview" style="display: none; background: rgba(255,255,255,0.15); border-radius: 10px; padding: 15px; margin-top: 15px;">
                        <h4 style="margin-bottom: 10px;">ì €ì¥ëœ êµ¬ê°„ ëª©ë¡</h4>
                        <div id="quotationListContent"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- í•˜ë‹¨ ì •ë³´ -->
    <div class="footer-info">
        <h3>ê°€ì„¤íŒŒíŠ¸ë„ˆ</h3>
        <p>
            ê°€ì„¤ì¬ í”„ë¡œê·¸ë¨ ë° êµ¬ì¡° ê²€í† <br>
            ğŸ“ ë¬¸ì˜: 010-7970-2108 | âœ‰ï¸ ì´ë©”ì¼: fc112@naver.com<br>
            ğŸŒ ì›¹ì‚¬ì´íŠ¸: <a href="https://gaseolpartner.com" target="_blank">gaseolpartner.com</a>
        </p>
        <div class="copyright">
            <p>
                Â© 2025 ê°€ì„¤íŒŒíŠ¸ë„ˆ. All rights reserved.<br>
                ë³¸ í”„ë¡œê·¸ë¨ì˜ ëª¨ë“  ì €ì‘ê¶Œì€ ê°€ì„¤íŒŒíŠ¸ë„ˆì— ìˆìŠµë‹ˆë‹¤.<br>
                ë¬´ë‹¨ ë³µì œ ë° ë°°í¬ë¥¼ ê¸ˆì§€í•©ë‹ˆë‹¤.
            </p>
        </div>
    </div>
    
    <script>
        // ì´ˆê¸° ë³´ì•ˆ ê²½ê³ 
        console.log('%câš ï¸ ì •ì§€!', 'color: red; font-size: 50px; font-weight: bold;');
        console.log('%cë³¸ í”„ë¡œê·¸ë¨ì˜ ëª¨ë“  ì½”ë“œëŠ” ì €ì‘ê¶Œìœ¼ë¡œ ë³´í˜¸ë©ë‹ˆë‹¤.', 'color: red; font-size: 16px;');
        console.log('%cÂ© 2025 ê°€ì„¤íŒŒíŠ¸ë„ˆ. All rights reserved.', 'color: #2a5298; font-size: 16px; font-weight: bold;');
        
        // ì „ì—­ ë³€ìˆ˜
        let currentStructureType = 'wall';
        let calculatedMaterials = {};
        let priceData = {};
        let savedCalculations = [];
        let selectedDataIndices = [];
        let savedPriceInputs = {}; // ë‹¨ê°€ ì…ë ¥ê°’ ì €ì¥ìš©
        let quotationSections = []; // ë‹¤ì¤‘ êµ¬ê°„ ê²¬ì  ì €ì¥ìš©
        
        // Google Analytics ë°ì´í„° ì „ì†¡ í•¨ìˆ˜
function sendPriceAnalytics(structureType, materials, totalPrice, usageDays) {
    // í‰ê·  ë‹¨ê°€ ê³„ì‚°
    let avgBasicPrice = 0;
    let avgDailyPrice = 0;
    let materialCount = 0;
    
    Object.keys(materials).forEach(key => {
        if (materials[key] && materials[key].quantity > 0) {
            const price = savedPriceInputs[key] || defaultPrices[key] || { basic: 0, daily: 0 };
            avgBasicPrice += price.basic;
            avgDailyPrice += price.daily;
            materialCount++;
        }
    });
    
    if (materialCount > 0) {
        avgBasicPrice = Math.round(avgBasicPrice / materialCount);
        avgDailyPrice = Math.round(avgDailyPrice / materialCount);
    }
    
    // 1. ì „ì²´ ê³„ì‚° ì´ë²¤íŠ¸
    gtag('event', 'price_calculation', {
        'event_category': 'ë‹¨ê°€ê³„ì‚°',
        'event_label': structureType,
        'value': totalPrice,
        'structure_type': structureType,
        'avg_basic_price': avgBasicPrice,
        'avg_daily_price': avgDailyPrice,
        'total_price': totalPrice,
        'material_count': materialCount,
        'usage_days': usageDays
    });
    
    // 2. ìì¬ë³„ ìƒì„¸ ì´ë²¤íŠ¸
    Object.keys(materials).forEach(key => {
        if (materials[key] && materials[key].quantity > 0) {
            const price = savedPriceInputs[key] || defaultPrices[key] || { basic: 0, daily: 0 };
            gtag('event', 'material_price', {
                'event_category': 'ìì¬ë‹¨ê°€',
                'event_label': materialNames[key],
                'structure_type': structureType,
                'material_name': materialNames[key],
                'material_code': key,
                'basic_price': price.basic,
                'daily_price': price.daily,
                'quantity': materials[key].quantity,
                'usage_days': usageDays
            });
        }
    });
}

        // êµ¬ì¡°ë³„ ìì¬ ë¹„ìœ¨ ë°ì´í„° (ì—‘ì…€ íŒŒì¼ ê¸°ë°˜ - 1ã¥ë‹¹ ë¹„ìœ¨)
        const materialRatios = {
            wall: {
                name: 'ë²½ì‹êµ¬ì¡°',
                ratios: {
                    'P17': { ratio: 0.16203370301022613, weight: 8.0 },
                    'P12': { ratio: 0.07921647702722166, weight: 6.2 },
                    'P08': { ratio: 0.12017499639925106, weight: 4.4 },
                    'P04': { ratio: 0.06361323155216285, weight: 3.0 },
                    'P02': { ratio: 0.06121273224830765, weight: 2.0 },
                    'H18': { ratio: 0.03795189399395075, weight: 5.0 },
                    'H15': { ratio: 0.03478323491286187, weight: 4.3 },
                    'H12': { ratio: 0.1114791876710356, weight: 3.5 },
                    'H09': { ratio: 0.0653896010370157, weight: 2.8 },
                    'H06': { ratio: 0.04918623073599309, weight: 2.1 },
                    'H03': { ratio: 0.011018291804695378, weight: 1.3 },
                    'H': { ratio: 0.16383407748811754, weight: 5.4 },
                    'J': { ratio: 0.16383407748811754, weight: 5.0 },
                    'S': { ratio: 0.16383407748811754, weight: 0.5 },
                    'T': { ratio: 0, weight: 19.5 },
                    'M3': { ratio: 0.008137692640069135, weight: 27.0 },
                    'M2.5': { ratio: 0.03816793893129771, weight: 22.5 },
                    'M2': { ratio: 0.028445916750684145, weight: 18.0 },
                    'M1.5': { ratio: 0.009650007201497912, weight: 13.5 },
                    'M1': { ratio: 0.008929857410341352, weight: 9.0 }
                }
            },
            truss: {
                name: 'íŠ¸ëŸ¬ìŠ¤êµ¬ì¡°',
                ratios: {
                    'P17': { ratio: 0.14157582337749428, weight: 8.0 },
                    'P12': { ratio: 0.04081328527387373, weight: 6.2 },
                    'P08': { ratio: 0.046335067039752834, weight: 4.4 },
                    'P04': { ratio: 0.06902360262331203, weight: 3.0 },
                    'P02': { ratio: 0.08456974675645217, weight: 2.0 },
                    'H18': { ratio: 0.0025985638045209424, weight: 5.0 },
                    'H15': { ratio: 0.034871049763893935, weight: 4.3 },
                    'H12': { ratio: 0.07328668425653533, weight: 3.5 },
                    'H09': { ratio: 0.03357775533583743, weight: 2.8 },
                    'H06': { ratio: 0.03127856524151475, weight: 2.1 },
                    'H03': { ratio: 0.00460104128829156, weight: 1.3 },
                    'H': { ratio: 0.16903837172634847, weight: 5.4 },
                    'J': { ratio: 0.14157582337749428, weight: 5.0 },
                    'S': { ratio: 0.14157582337749428, weight: 0.5 },
                    'T': { ratio: 0.0137312741744271, weight: 19.5 },
                    'M3': { ratio: 0.02000614714018274, weight: 27.0 },
                    'M2.5': { ratio: 0.007839599557725238, weight: 22.5 },
                    'M2': { ratio: 0.04039549262941926, weight: 18.0 },
                    'M1.5': { ratio: 0.0212036419809758, weight: 13.5 },
                    'M1': { ratio: 0.0030400402358266507, weight: 9.0 }
                }
            },
            beam: {
                name: 'ë‹¨ë…ë³´êµ¬ì¡°',
                ratios: {
                    'P17': { ratio: 0.19767223577998871, weight: 8.0 },
                    'P12': { ratio: 0.01536981415430824, weight: 6.2 },
                    'P08': { ratio: 0.07555847568988174, weight: 4.4 },
                    'P04': { ratio: 0.05162380326637882, weight: 3.0 },
                    'P02': { ratio: 0.09395532194480945, weight: 2.0 },
                    'H18': { ratio: 0.014783180026281208, weight: 5.0 },
                    'H15': { ratio: 0.01933546085977098, weight: 4.3 },
                    'H12': { ratio: 0.14473437206682935, weight: 3.5 },
                    'H09': { ratio: 0.07687253613666228, weight: 2.8 },
                    'H06': { ratio: 0.08043927163506663, weight: 2.1 },
                    'H03': { ratio: 0.006276985169889243, weight: 1.3 },
                    'H': { ratio: 0.19767223577998871, weight: 5.4 },
                    'J': { ratio: 0.19767223577998871, weight: 5.0 },
                    'S': { ratio: 0.19767223577998871, weight: 0.5 },
                    'T': { ratio: 0, weight: 19.5 },
                    'M3': { ratio: 0.023934672423502907, weight: 27.0 },
                    'M2.5': { ratio: 0.021118828608973152, weight: 22.5 },
                    'M2': { ratio: 0.019992491083161253, weight: 18.0 },
                    'M1.5': { ratio: 0.027032100619485636, weight: 13.5 },
                    'M1': { ratio: 0.006523371503660597, weight: 9.0 }
                }
            },
            tg: {
                name: 'TGë³´êµ¬ì¡°',
                ratios: {
                    'P17': { ratio: 0.4330397470641373, weight: 8.0 },
                    'P12': { ratio: 0.04375564588979223, weight: 6.2 },
                    'P08': { ratio: 0.08624096657633243, weight: 4.4 },
                    'P04': { ratio: 0.22193992773261068, weight: 3.0 },
                    'P02': { ratio: 0.19546070460704607, weight: 2.0 },
                    'H18': { ratio: 0.00818654019873532, weight: 5.0 },
                    'H15': { ratio: 0.026140469738030712, weight: 4.3 },
                    'H12': { ratio: 0.12042682926829269, weight: 3.5 },
                    'H09': { ratio: 0.20172764227642276, weight: 2.8 },
                    'H06': { ratio: 0.4693992773261066, weight: 2.1 },
                    'H03': { ratio: 0.04477190605239385, weight: 1.3 },
                    'H': { ratio: 0.3517389340560072, weight: 5.4 },
                    'J': { ratio: 0.3517389340560072, weight: 5.0 },
                    'S': { ratio: 0.3517389340560072, weight: 0.5 },
                    'T': { ratio: 0, weight: 19.5 },
                    'M3': { ratio: 0.011630532971996387, weight: 27.0 },
                    'M2.5': { ratio: 0.01388888888888889, weight: 22.5 },
                    'M2': { ratio: 0.043642728093947605, weight: 18.0 },
                    'M1.5': { ratio: 0.02958446251129178, weight: 13.5 },
                    'M1': { ratio: 0.05634598012646793, weight: 9.0 }
                }
            },
            tp: {
                name: 'TPêµ¬ì¡°',
                ratios: {
                    'P17': { ratio: 0.4602929838087895, weight: 8.0 },
                    'P12': { ratio: 0, weight: 6.2 },
                    'P08': { ratio: 0.5165767154973016, weight: 4.4 },
                    'P04': { ratio: 0.09020817270624519, weight: 3.0 },
                    'P02': { ratio: 0.553585196607556, weight: 2.0 },
                    'H18': { ratio: 0, weight: 5.0 },
                    'H15': { ratio: 0.004626060138781804, weight: 4.3 },
                    'H12': { ratio: 0.015265998457979955, weight: 3.5 },
                    'H09': { ratio: 0.3365458750963763, weight: 2.8 },
                    'H06': { ratio: 0.4592521202775636, weight: 2.1 },
                    'H03': { ratio: 0.03781804163454125, weight: 1.3 },
                    'H': { ratio: 0.4556669236700077, weight: 5.4 },
                    'J': { ratio: 0.4556669236700077, weight: 5.0 },
                    'S': { ratio: 0.4556669236700077, weight: 0.5 },
                    'T': { ratio: 0, weight: 19.5 },
                    'M3': { ratio: 0.03006939090208173, weight: 27.0 },
                    'M2.5': { ratio: 0.13010794140323825, weight: 22.5 },
                    'M2': { ratio: 0.01734772552043177, weight: 18.0 },
                    'M1.5': { ratio: 0.010986892829606786, weight: 13.5 },
                    'M1': { ratio: 0.005088666152659985, weight: 9.0 }
                }
            },
            ramp: {
                name: 'RAMP',
                ratios: {
                    'P17': { ratio: 0.28581448360512013, weight: 8.0 },
                    'P12': { ratio: 0.07434683499912327, weight: 6.2 },
                    'P08': { ratio: 0.0680343678765562, weight: 4.4 },
                    'P04': { ratio: 0.16657899351218658, weight: 3.0 },
                    'P02': { ratio: 0.2735402419779064, weight: 2.0 },
                    'H18': { ratio: 0, weight: 5.0 },
                    'H15': { ratio: 0.06961248465719798, weight: 4.3 },
                    'H12': { ratio: 0.21637734525688238, weight: 3.5 },
                    'H09': { ratio: 0.07908118534104858, weight: 2.8 },
                    'H06': { ratio: 0.07960722426792917, weight: 2.1 },
                    'H03': { ratio: 0.027003331579870248, weight: 1.3 },
                    'H': { ratio: 0.28581448360512013, weight: 5.4 },
                    'J': { ratio: 0.28581448360512013, weight: 5.0 },
                    'S': { ratio: 0.28581448360512013, weight: 0.5 },
                    'T': { ratio: 0, weight: 19.5 },
                    'M3': { ratio: 0.03015956514115378, weight: 27.0 },
                    'M2.5': { ratio: 0.009644046992810802, weight: 22.5 },
                    'M2': { ratio: 0.06435209538839208, weight: 18.0 },
                    'M1.5': { ratio: 0.041732421532526744, weight: 13.5 },
                    'M1': { ratio: 0.010959144310012275, weight: 9.0 }
                }
            },
            deck: {
                name: 'DECK',
                ratios: {
                    'P17': { ratio: 0.20256109226889296, weight: 8.0 },
                    'P12': { ratio: 0, weight: 6.2 },
                    'P08': { ratio: 0.008948604226454476, weight: 4.4 },
                    'P04': { ratio: 0.3064309939994782, weight: 3.0 },
                    'P02': { ratio: 0.16184450821810592, weight: 2.0 },
                    'H18': { ratio: 0.2769240803548135, weight: 5.0 },
                    'H15': { ratio: 0.002625228280720063, weight: 4.3 },
                    'H12': { ratio: 0.4663448995564832, weight: 3.5 },
                    'H09': { ratio: 0.4663448995564832, weight: 2.8 },
                    'H06': { ratio: 0.4663448995564832, weight: 2.1 },
                    'H03': { ratio: 0, weight: 1.3 },
                    'H': { ratio: 0.15632663709887817, weight: 5.4 },
                    'J': { ratio: 0.05980954865640491, weight: 5.0 },
                    'S': { ratio: 0.017691755804852598, weight: 0.5 },
                    'T': { ratio: 0.04300808765979651, weight: 19.5 },
                    'M3': { ratio: 0.03542916775371772, weight: 27.0 },
                    'M2.5': { ratio: 0, weight: 22.5 },
                    'M2': { ratio: 0, weight: 18.0 },
                    'M1.5': { ratio: 0, weight: 13.5 },
                    'M1': { ratio: 0, weight: 9.0 }
                }
            },
            deck900: {
                name: 'DECK+900',
                ratios: {
                    'P17': { ratio: 0.5585288870591464, weight: 8.0 },
                    'P12': { ratio: 0, weight: 6.2 },
                    'P08': { ratio: 0.46932894195142033, weight: 4.4 },
                    'P04': { ratio: 0.13357119985362062, weight: 3.0 },
                    'P02': { ratio: 0.23054755043227665, weight: 2.0 },
                    'H18': { ratio: 0.09729655550981199, weight: 5.0 },
                    'H15': { ratio: 0.016284707927359227, weight: 4.3 },
                    'H12': { ratio: 0.12927130506381226, weight: 3.5 },
                    'H09': { ratio: 0.47687662961438176, weight: 2.8 },
                    'H06': { ratio: 0.2626595306710581, weight: 2.1 },
                    'H03': { ratio: 0.004940304652120214, weight: 1.3 },
                    'H': { ratio: 0.38753945382187455, weight: 5.4 },
                    'J': { ratio: 0.5585288870591464, weight: 5.0 },
                    'S': { ratio: 0.38753945382187455, weight: 0.5 },
                    'T': { ratio: 0, weight: 19.5 },
                    'M3': { ratio: 0.12186084808563195, weight: 27.0 },
                    'M2.5': { ratio: 0.22341155482365857, weight: 22.5 },
                    'M2': { ratio: 0.029641827912721283, weight: 18.0 },
                    'M1.5': { ratio: 0.02579936873885001, weight: 13.5 },
                    'M1': { ratio: 0.06806641965143406, weight: 9.0 }
                }
            }
        };
        
        // ìì¬ ëª…ì¹­ ë§¤í•‘
        const materialNames = {
            'P17': 'ìˆ˜ì§ì¬ P17 (1725mm)',
            'P12': 'ìˆ˜ì§ì¬ P12 (1291mm)',
            'P08': 'ìˆ˜ì§ì¬ P08 (863mm)',
            'P04': 'ìˆ˜ì§ì¬ P04 (432mm)',
            'P02': 'ìˆ˜ì§ì¬ P02 (216mm)',
            'H18': 'ìˆ˜í‰ì¬ H18 (1829mm)',
            'H15': 'ìˆ˜í‰ì¬ H15 (1524mm)',
            'H12': 'ìˆ˜í‰ì¬ H12 (1219mm)',
            'H09': 'ìˆ˜í‰ì¬ H09 (914mm)',
            'H06': 'ìˆ˜í‰ì¬ H06 (610mm)',
            'H03': 'ìˆ˜í‰ì¬ H03 (305mm)',
            'H': 'í—¤ë“œì­',
            'J': 'ì­ë² ì´ìŠ¤',
            'S': 'ì†Œì¼“',
            'T': 'íŠ¸ëŸ¬ìŠ¤',
            'M3': 'ë©ì—ì¬ 3M',
            'M2.5': 'ë©ì—ì¬ 2.5M',
            'M2': 'ë©ì—ì¬ 2M',
            'M1.5': 'ë©ì—ì¬ 1.5M',
            'M1': 'ë©ì—ì¬ 1M'
        };
        
        // ê¸°ë³¸ ë‹¨ê°€ ë°ì´í„°
        const defaultPrices = {
            'P17': { basic: 5000, daily: 160 },
            'P12': { basic: 3800, daily: 120 },
            'P08': { basic: 2500, daily: 80 },
            'P04': { basic: 1300, daily: 40 },
            'P02': { basic: 700, daily: 20 },
            'H18': { basic: 2500, daily: 80 },
            'H15': { basic: 2100, daily: 70 },
            'H12': { basic: 1700, daily: 55 },
            'H09': { basic: 1300, daily: 40 },
            'H06': { basic: 900, daily: 30 },
            'H03': { basic: 500, daily: 15 },
            'H': { basic: 2700, daily: 90 },
            'J': { basic: 2500, daily: 80 },
            'S': { basic: 300, daily: 10 },
            'T': { basic: 10000, daily: 330 },
            'M3': { basic: 8000, daily: 260 },
            'M2.5': { basic: 6700, daily: 220 },
            'M2': { basic: 5400, daily: 180 },
            'M1.5': { basic: 4000, daily: 130 },
            'M1': { basic: 2700, daily: 90 }
        };
        
        // êµ¬ì¡° íƒ€ì… ì„ íƒ
        function selectStructureType(type, element) {
            currentStructureType = type;
            
            // ëª¨ë“  ì¹´ë“œì—ì„œ active ì œê±°
            document.querySelectorAll('.structure-type-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // ì„ íƒëœ ì¹´ë“œì— active ì¶”ê°€
            if (element) {
                element.classList.add('active');
            }
        }
        
        // ì•ˆì „ìœ¨ ìŠ¬ë¼ì´ë” ì—…ë°ì´íŠ¸
        document.getElementById('safetyRate').addEventListener('input', function() {
            document.getElementById('safetyRateDisplay').textContent = this.value;
        });
        
        // ë¬¼ëŸ‰ ê³„ì‚°
        function calculateQuantity() {
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const volume = parseFloat(document.getElementById('volume').value);
            const height = parseFloat(document.getElementById('height').value);
            const slabThk = parseFloat(document.getElementById('slabThk').value);
            const beamThk = parseFloat(document.getElementById('beamThk').value);
            const safetyRate = parseFloat(document.getElementById('safetyRate').value) / 100;
            
            // ìœ íš¨ì„± ê²€ì‚¬
            if (!volume || !height || !slabThk) {
                alert('ëª¨ë“  í•„ìˆ˜ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì‹¤ì‘ì—… ë†’ì´ ê³„ì‚° (ì—‘ì…€ì˜ E6 ìˆ˜ì‹ê³¼ ë™ì¼)
            // E6: C2-SUM(C3:C7,E2:E5)
            // C2: ì¸µê³ , C3: ìŠ¬ë¼ë¸Œ, C4: ë³´, C5: í•©íŒ(12), C6: ì¥ì„ 1(50), C7: ì¥ì„ 2(0)
            // E2: ë©ì—(125), E3: í—¤ë“œë² ì´ìŠ¤(300), E4: ì­ë² ì´ìŠ¤(300), E5: ì†Œì¼“(120)
            const workHeight = height - slabThk - beamThk - 12 - 50 - 0 - 125 - 300 - 300 - 120;
            
            // í—¤ë“œì­ ë†’ì´ëŠ” ì‹¤ì œë¡œ 305.5mm ì‚¬ìš©
            const headerHeight = 305.5;
            const jacketHeight = 305.5;
            
            // í˜„ì¬ êµ¬ì¡° íƒ€ì…ì˜ ë¹„ìœ¨ ê°€ì ¸ì˜¤ê¸°
            const structureData = materialRatios[currentStructureType];
            const ratios = structureData.ratios;
            
            // ìˆ˜ì§ì¬ ê·œê²©
            const verticalSizes = {
                'P17': 1725,
                'P12': 1291,
                'P08': 863,
                'P04': 432,
                'P02': 216
            };
            
            // ìì¬ë³„ ìˆ˜ëŸ‰ ê³„ì‚°
            const materials = {};
            let totalWeight = 0;
            
            // ìˆ˜ì§ì¬ ë‹¨ìˆ˜ ê³„ì‚° (ì—‘ì…€ ë°©ì‹ êµ¬í˜„)
            const verticalLayers = {};
            
            // P17: QUOTIENT(E6,C9) = QUOTIENT(ì‹¤ì‘ì—…ë†’ì´, 1725)
            verticalLayers['P17'] = Math.floor(workHeight / verticalSizes['P17']);
            const remainder1 = workHeight % verticalSizes['P17']; // MOD(E6,C9)
            
            // P12: QUOTIENT(D9,C10) = QUOTIENT(443, 1291)
            verticalLayers['P12'] = Math.floor(remainder1 / verticalSizes['P12']);
            const remainder2 = remainder1 % verticalSizes['P12']; // MOD(D9,C10)
            
            // P08: QUOTIENT(D10,C11) = QUOTIENT(443, 863)
            verticalLayers['P08'] = Math.floor(remainder2 / verticalSizes['P08']);
            const remainder3 = remainder2 % verticalSizes['P08']; // MOD(D10,C11)
            
            // P04: QUOTIENT(D11,C12) = QUOTIENT(443, 432)
            verticalLayers['P04'] = Math.floor(remainder3 / verticalSizes['P04']);
            const remainder4 = remainder3 % verticalSizes['P04']; // MOD(D11,C12)
            
            // P02: QUOTIENT(D12,C13) = QUOTIENT(11, 216)
            verticalLayers['P02'] = Math.floor(remainder4 / verticalSizes['P02']);
            
            // ìˆ˜í‰ì¬ ë‹¨ìˆ˜ ê³„ì‚°
            // B36: SUM(E9:E13) - ëª¨ë“  ìˆ˜ì§ì¬ ë‹¨ìˆ˜ì˜ í•©
            // C36: SUM(E11:E13) - P08, P04, P02ì˜ ë‹¨ìˆ˜ í•©
            // D36: SUM(E9:E13)+1 - ëª¨ë“  ìˆ˜ì§ì¬ ë‹¨ìˆ˜ì˜ í•© + 1
            // F36: IF(C36=1, B36, D36)
            
            const totalVerticalLayers = Object.values(verticalLayers).reduce((sum, val) => sum + val, 0);
            const smallVerticalLayers = (verticalLayers['P08'] || 0) + (verticalLayers['P04'] || 0) + (verticalLayers['P02'] || 0);
            
            let horizontalLayers;
            if (smallVerticalLayers === 1) {
                horizontalLayers = totalVerticalLayers;
            } else {
                horizontalLayers = totalVerticalLayers + 1;
            }
            
            // ê° ìì¬ë³„ ìˆ˜ëŸ‰ ê³„ì‚°
            for (const [material, data] of Object.entries(ratios)) {
                if (data.ratio > 0) {
                    let quantity = 0;
                    
                    // ìˆ˜ì§ì¬ ìˆ˜ëŸ‰ ê³„ì‚°: HLOOKUP * ê³µë£¨ë²  * ë‹¨ìˆ˜
                    if (verticalSizes[material]) {
                        const layers = verticalLayers[material] || 0;
                        quantity = data.ratio * volume * layers;
                    }
                    // ìˆ˜í‰ì¬ ìˆ˜ëŸ‰ ê³„ì‚°: HLOOKUP * ê³µë£¨ë²  * ìˆ˜í‰ì¬ë‹¨ìˆ˜
                    else if (material.startsWith('H') && material.length === 3) {
                        quantity = data.ratio * volume * horizontalLayers;
                    }
                    // ê¸°íƒ€ ìì¬ ìˆ˜ëŸ‰ ê³„ì‚°: HLOOKUP * ê³µë£¨ë² 
                    else {
                        quantity = data.ratio * volume;
                    }
                    
                    // ì•ˆì „ìœ¨ ì ìš©
                    quantity = quantity * (1 + safetyRate);
                    
                    if (quantity > 0) {
                        materials[material] = {
                            quantity: Math.ceil(quantity),
                            weight: Math.ceil(quantity) * data.weight,
                            unitWeight: data.weight
                        };
                        
                        totalWeight += materials[material].weight;
                    }
                }
            }
            
            // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
            calculatedMaterials = materials;
            
            // ê²°ê³¼ í‘œì‹œ
            displayResults(materials, volume, workHeight, totalWeight, structureData.name);
            
            // ë‹¨ê°€ ì…ë ¥ í•„ë“œ ìƒì„±
            createPriceInputFields(materials);
        }
        
        // ë‹¨ê°€ ì…ë ¥ í•„ë“œ ìƒì„±
        function createPriceInputFields(materials) {
            const priceInputGrid = document.getElementById('priceInputGrid');
            priceInputGrid.innerHTML = '';
            
            const allMaterials = ['P17', 'P12', 'P08', 'P04', 'P02', 'H18', 'H15', 'H12', 'H09', 'H06', 'H03', 'H', 'J', 'S', 'T', 'M3', 'M2.5', 'M2', 'M1.5', 'M1'];
            
            allMaterials.forEach(material => {
                if (materials[material] && materials[material].quantity > 0) {
                    const item = document.createElement('div');
                    item.className = 'price-input-item';
                    
                    const savedPrice = savedPriceInputs[material] || defaultPrices[material] || { basic: 0, daily: 0 };
                    
                    item.innerHTML = `
                        <label>${materialNames[material]}</label>
                        <input type="number" id="basic_${material}" placeholder="ê¸°ë³¸ë£Œ" value="${savedPrice.basic}" min="0" step="100">
                        <input type="number" id="daily_${material}" placeholder="ì¼ë‹¨ê°€" value="${savedPrice.daily}" min="0" step="10">
                    `;
                    priceInputGrid.appendChild(item);
                }
            });
        }
        
        // ë‹¨ê°€ ì„¹ì…˜ í† ê¸€
        function togglePriceSection() {
            const container = document.getElementById('priceInputContainer');
            const btn = document.querySelector('.toggle-price-btn');
            
            if (container.style.display === 'none') {
                container.style.display = 'block';
                btn.textContent = 'ë‹¨ê°€ ì…ë ¥ ë‹«ê¸°';
            } else {
                container.style.display = 'none';
                btn.textContent = 'ë‹¨ê°€ ì…ë ¥';
            }
        }
        
        // ê¸ˆì•¡ ê³„ì‚°
        function calculatePrice() {
            const usageDays = parseInt(document.getElementById('usageDays').value) || 30;
            let totalPrice = 0;
            
            // ê° ìì¬ë³„ ê¸ˆì•¡ ê³„ì‚°
            Object.keys(calculatedMaterials).forEach(material => {
                const basicPrice = parseFloat(document.getElementById(`basic_${material}`)?.value) || 0;
                const dailyPrice = parseFloat(document.getElementById(`daily_${material}`)?.value) || 0;
                const quantity = calculatedMaterials[material].quantity;
                
                // ë‹¨ê°€ ì €ì¥
                savedPriceInputs[material] = { basic: basicPrice, daily: dailyPrice };
                
                // ì´ê¸ˆì•¡ = ìˆ˜ëŸ‰ Ã— (ê¸°ë³¸ë£Œ + (ì¼ë‹¨ê°€ Ã— ì‚¬ìš©ì¼ìˆ˜))
                const materialTotal = quantity * (basicPrice + (dailyPrice * usageDays));
                
                priceData[material] = {
                    basicPrice,
                    dailyPrice,
                    totalPrice: materialTotal
                };
                
                totalPrice += materialTotal;
            });
            
            // ê¸ˆì•¡ ì •ë³´ ì—…ë°ì´íŠ¸
            updatePriceDisplay(totalPrice);

            // Google Analytics ë°ì´í„° ì „ì†¡
    const structureType = materialRatios[currentStructureType].name;
    sendPriceAnalytics(structureType, calculatedMaterials, totalPrice, usageDays);
        }
        
        // ê¸ˆì•¡ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updatePriceDisplay(totalPrice) {
            // ê¸ˆì•¡ ê´€ë ¨ ì—´ í‘œì‹œ
            document.querySelectorAll('.price-column').forEach(col => {
                col.style.display = 'table-cell';
            });
            
            document.querySelectorAll('.price-summary').forEach(elem => {
                elem.style.display = 'block';
            });
            
            // ì´ ê¸ˆì•¡ í‘œì‹œ
            const volume = parseFloat(document.getElementById('volume').value);
            document.getElementById('totalPrice').textContent = totalPrice.toLocaleString() + 'ì›';
            document.getElementById('pricePerM3').textContent = Math.round(totalPrice / volume).toLocaleString() + 'ì›';
            
            // í…Œì´ë¸” ë‹¤ì‹œ ê·¸ë¦¬ê¸°
            displayResults(calculatedMaterials, volume, 
                parseFloat(document.getElementById('workHeight').textContent) * 1000,
                parseFloat(document.getElementById('totalWeight').textContent.replace('í†¤', '')) * 1000,
                materialRatios[currentStructureType].name,
                true);
        }
        
        // ê²°ê³¼ í‘œì‹œ
        function displayResults(materials, volume, workHeight, totalWeight, structureName, showPrice = false) {
            // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            document.getElementById('resultSection').style.display = 'block';
            
            // ê²°ê³¼ ì •ë³´
            document.getElementById('resultInfo').textContent = 
                `${structureName} | ê³µë£¨ë² : ${volume}ã¥`;
            
            // ì£¼ìš” ìˆ˜ëŸ‰ í‘œì‹œ
            let verticalTotal = 0;
            let horizontalTotal = 0;
            
            // ìˆ˜ì§ì¬ í•©ê³„
            ['P17', 'P12', 'P08', 'P04', 'P02'].forEach(key => {
                if (materials[key]) {
                    verticalTotal += materials[key].quantity;
                }
            });
            
            // ìˆ˜í‰ì¬ í•©ê³„
            ['H18', 'H15', 'H12', 'H09', 'H06', 'H03'].forEach(key => {
                if (materials[key]) {
                    horizontalTotal += materials[key].quantity;
                }
            });
            
            document.getElementById('verticalCount').textContent = verticalTotal.toLocaleString();
            document.getElementById('horizontalCount').textContent = horizontalTotal.toLocaleString();
            document.getElementById('uheadCount').textContent = materials['H'] ? materials['H'].quantity.toLocaleString() : '0';
            document.getElementById('baseCount').textContent = materials['J'] ? materials['J'].quantity.toLocaleString() : '0';
            
            // ìƒì„¸ í…Œì´ë¸” ìƒì„±
            const tbody = document.getElementById('detailTableBody');
            tbody.innerHTML = '';
            
            // ìì¬ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì •ë ¬
            const categories = [
                { title: 'ìˆ˜ì§ì¬', items: ['P17', 'P12', 'P08', 'P04', 'P02'] },
                { title: 'ìˆ˜í‰ì¬', items: ['H18', 'H15', 'H12', 'H09', 'H06', 'H03'] },
                { title: 'ë¶€ì†ìì¬', items: ['H', 'J', 'S', 'T'] },
                { title: 'ë©ì—ì¬', items: ['M3', 'M2.5', 'M2', 'M1.5', 'M1'] }
            ];
            
            let totalPrice = 0;
            
            categories.forEach(category => {
                let categoryHasItems = false;
                
                // ë¨¼ì € í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— í•­ëª©ì´ ìˆëŠ”ì§€ í™•ì¸
                category.items.forEach(item => {
                    if (materials[item] && materials[item].quantity > 0) {
                        categoryHasItems = true;
                    }
                });
                
                // í•­ëª©ì´ ìˆì„ ë•Œë§Œ ì¹´í…Œê³ ë¦¬ í—¤ë” ì¶”ê°€
                if (categoryHasItems) {
                    const headerRow = tbody.insertRow();
                    const colspan = showPrice ? 8 : 5;
                    headerRow.innerHTML = `<td colspan="${colspan}" style="background: #e8f0ff; font-weight: bold; color: #1e3c72; font-size: 15px;">${category.title}</td>`;
                    
                    // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ìì¬ë“¤
                    category.items.forEach(item => {
                        if (materials[item] && materials[item].quantity > 0) {
                            const row = tbody.insertRow();
                            let rowHTML = `
                                <td>${materialNames[item]}</td>
                                <td>${item}</td>
                                <td style="text-align: right;">${materials[item].quantity.toLocaleString()}</td>
                                <td style="text-align: right;">${materials[item].unitWeight.toFixed(1)}</td>
                                <td style="text-align: right;">${materials[item].weight.toFixed(0).toLocaleString()}</td>
                            `;
                            
                            if (showPrice && priceData[item]) {
                                const itemTotalPrice = priceData[item].totalPrice;
                                totalPrice += itemTotalPrice;
                                rowHTML += `
                                    <td style="text-align: right;">${priceData[item].basicPrice.toLocaleString()}</td>
                                    <td style="text-align: right;">${priceData[item].dailyPrice.toLocaleString()}</td>
                                    <td style="text-align: right; font-weight: bold;">${itemTotalPrice.toLocaleString()}</td>
                                `;
                            }
                            
                            row.innerHTML = rowHTML;
                        }
                    });
                }
            });
            
            // í•©ê³„ í–‰
            const totalRow = tbody.insertRow();
            totalRow.style.fontWeight = 'bold';
            totalRow.style.background = '#2a5298';
            totalRow.style.color = 'white';
            
            if (showPrice) {
                totalRow.innerHTML = `
                    <td colspan="2">í•©ê³„</td>
                    <td style="text-align: right;">-</td>
                    <td style="text-align: right;">-</td>
                    <td style="text-align: right;">${totalWeight.toFixed(0).toLocaleString()}</td>
                    <td colspan="2" style="text-align: center;">ì´ ê¸ˆì•¡</td>
                    <td style="text-align: right;">${totalPrice.toLocaleString()}</td>
                `;
            } else {
                totalRow.innerHTML = `
                    <td colspan="2">í•©ê³„</td>
                    <td style="text-align: right;">-</td>
                    <td style="text-align: right;">-</td>
                    <td style="text-align: right;">${totalWeight.toFixed(0).toLocaleString()}</td>
                `;
            }
            
            // ìš”ì•½ ì •ë³´
            document.getElementById('totalVolume').textContent = `${volume}ã¥`;
            document.getElementById('workHeight').textContent = `${(workHeight / 1000).toFixed(2)}m`;
            document.getElementById('totalWeight').textContent = `${(totalWeight / 1000).toFixed(1)}í†¤`;
            document.getElementById('weightPerM3').textContent = `${(totalWeight / volume).toFixed(1)}kg`;
            
            // í˜ì´ì§€ ìŠ¤í¬ë¡¤
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        
        // ê²¬ì ì„œ ìƒì„± (ìƒˆ ë²„ì „)
        function generateQuotation() {
            if (Object.keys(calculatedMaterials).length === 0) {
                alert('ë¨¼ì € ë¬¼ëŸ‰ ê³„ì‚°ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            var companyName = prompt('ì—…ì²´ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:', '');
            if (!companyName) return;
            
            var projectName = prompt('ê³µì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:', '');
            if (!projectName) return;
            
            var volume = parseFloat(document.getElementById('volume').value) || 0;
            var usageDays = parseInt(document.getElementById('usageDays').value) || 30;
            var structureName = materialRatios[currentStructureType].name;
            
            var totalAmount = 0;
            var itemsHTML = '';
            
            var specs = {
                'P17': '1725mm', 'P12': '1225mm', 'P08': '825mm', 'P04': '425mm', 'P02': '216mm',
                'H18': '1829mm', 'H15': '1524mm', 'H12': '1219mm', 'H09': '914mm', 'H06': '610mm', 'H03': '305mm',
                'H': '-', 'J': '-', 'S': '-', 'T': '-',
                'M3': '3000mm', 'M2.5': '2500mm', 'M2': '2000mm', 'M1.5': '1500mm', 'M1': '1000mm'
            };
            
            var materialOrder = ['P17', 'P12', 'P08', 'P04', 'P02', 'H18', 'H15', 'H12', 'H09', 'H06', 'H03', 'H', 'J', 'S', 'T', 'M3', 'M2.5', 'M2', 'M1.5', 'M1'];
            
            for (var i = 0; i < materialOrder.length; i++) {
                var key = materialOrder[i];
                if (calculatedMaterials[key] && calculatedMaterials[key].quantity > 0) {
                    var material = calculatedMaterials[key];
                    var qty = material.quantity;
                    var price = savedPriceInputs[key] || { basic: 0, daily: 0 };
                    var unitPrice = price.basic + (price.daily * usageDays);
                    var amount = unitPrice * qty;
                    totalAmount += amount;
                    
                    itemsHTML += '<tr><td>' + (materialNames[key] || key) + '</td><td>' + (specs[key] || key) + '</td><td>EA</td>' +
                        '<td class="num">' + qty.toLocaleString() + '</td><td>' + usageDays + '</td>' +
                        '<td class="num">' + unitPrice.toLocaleString() + '</td><td class="num">' + amount.toLocaleString() + '</td></tr>';
                }
            }
            
            var pricePerM3 = volume > 0 ? Math.round(totalAmount / volume) : 0;
            var today = new Date();
            var dateStr = today.getFullYear() + '. ' + String(today.getMonth()+1).padStart(2,'0') + '. ' + String(today.getDate()).padStart(2,'0');
            
            var quotationHTML = '<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><title>ê²¬ì ì„œ</title>' +
                '<style>@page{size:A4;margin:10mm 15mm}@media print{body{-webkit-print-color-adjust:exact}}' +
                '*{margin:0;padding:0;box-sizing:border-box}body{font-family:"Malgun Gothic",sans-serif;font-size:11px;line-height:1.4;color:#000;background:#fff}' +
                '.container{max-width:210mm;margin:0 auto;padding:15px 25px}' +
                '.title{text-align:center;font-size:28px;font-weight:bold;letter-spacing:20px;margin-bottom:25px;padding-bottom:15px;border-bottom:2px solid #000}' +
                '.header-info{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px}' +
                '.company-name{font-size:18px;font-weight:bold;margin-bottom:5px}' +
                '.amount-box{text-align:right}.amount-label{font-size:12px;color:#666}.amount-value{font-size:24px;font-weight:bold}' +
                '.project-name{background:#f5f5f5;padding:10px 15px;margin-bottom:15px;font-size:13px}' +
                'table{width:100%;border-collapse:collapse;margin-bottom:15px;font-size:11px}' +
                'th{background:#e8e8e8;border:1px solid #999;padding:8px 5px;font-weight:bold;text-align:center}' +
                'td{border:1px solid #ccc;padding:6px 5px;text-align:center}td.num{text-align:right;padding-right:8px}' +
                '.total-row{background:#f0f0f0;font-weight:bold}.total-row td{border:1px solid #999}' +
                '.notes{background:#fafafa;border:1px solid #ddd;padding:12px 15px;margin-top:15px}' +
                '.notes h4{font-size:12px;margin-bottom:8px}.notes ul{margin:0;padding-left:18px}.notes li{margin:3px 0;font-size:11px}' +
                '.footer{margin-top:20px;text-align:right;font-size:12px}.footer p{margin:3px 0}.company-stamp{font-size:16px;font-weight:bold;margin-top:15px}' +
                '</style></head><body><div class="container">' +
                '<h1 class="title">ê²¬ ì  ì„œ</h1>' +
                '<div class="header-info"><div><div class="company-name">' + companyName + ' ê·€í•˜</div></div>' +
                '<div class="amount-box"><div class="amount-label">ê¸ˆ ì•¡</div><div class="amount-value">â‚© ' + totalAmount.toLocaleString() + '</div></div></div>' +
                '<div class="project-name"><strong>ê³µì‚¬ëª…:</strong> ' + projectName + ' (ì‹œìŠ¤í…œë™ë°”ë¦¬)</div>' +
                '<table><thead><tr><th style="width:18%">í’ˆëª…</th><th style="width:14%">ê·œê²©</th><th style="width:8%">ë‹¨ìœ„</th>' +
                '<th style="width:12%">ìˆ˜ëŸ‰</th><th style="width:10%">ì¼ìˆ˜</th><th style="width:14%">ë‹¨ê°€</th><th style="width:18%">ê¸ˆì•¡</th></tr></thead>' +
                '<tbody>' + itemsHTML + '</tbody>' +
                '<tfoot><tr class="total-row"><td colspan="6" style="text-align:center">í•© ê³„</td><td class="num">â‚© ' + totalAmount.toLocaleString() + '</td></tr></tfoot></table>' +
                '<div class="notes"><h4>[ ë¹„ ê³  ]</h4><ul>' +
                '<li>ë¶€ê°€ì„¸ ë³„ë„</li>' +
                '<li>ìì¬ëŠ” ì¼ë‹¨ê°€ ì²­êµ¬ì¡°ê±´ì´ë©°, ì‹œí—˜ì— í•„ìš”í•œ ìì¬ë¹„ ë° ê²½ë¹„ ë³„ë„ ì¡°ê±´</li>' +
                '<li>ë¬¼ëŸ‰ ì‚°ì¶œ ê¸°ì¤€: ' + structureName + ' / ' + volume.toLocaleString() + 'ã¥</li>' +
                '<li>ã¥ë‹¹ ë‹¨ê°€: ' + pricePerM3.toLocaleString() + 'ì› (' + usageDays + 'ì¼ ê¸°ì¤€)</li>' +
                '<li>ë¬¼ëŸ‰ì€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë©°, ì‹¤ì œ ì„¤ì¹˜ ë¬¼ëŸ‰ìœ¼ë¡œ ì •ì‚° ì¡°ê±´</li>' +
                '<li>ìš´ë°˜ë¹„ í¸ë„ ì¡°ê±´ì´ë©°, 11í†¤ ë¯¸ë§Œ ì¶œê³ ì‹œ ì²­êµ¬ì¡°ê±´</li>' +
                '</ul></div>' +
                '<div class="footer"><p>' + dateStr + '</p><p class="company-stamp">ê°€ì„¤íŒŒíŠ¸ë„ˆ</p><p>ğŸ“ 010-7970-2108 | âœ‰ï¸ fc112@naver.com</p></div>' +
                '</div><script>window.onload=function(){window.print();}<\/script></body></html>';
            
            var printWindow = window.open('', '_blank');
            printWindow.document.write(quotationHTML);
            printWindow.document.close();
        }
        
        // ë‹¨ê°€ ë°ì´í„° ì €ì¥
        // ë‹¨ê°€ ë°ì´í„° ì €ì¥
        function savePriceData() {
            const priceDataToSave = {};
            const allMaterials = ['P17', 'P12', 'P08', 'P04', 'P02', 'H18', 'H15', 'H12', 'H09', 'H06', 'H03', 'H', 'J', 'S', 'T', 'M3', 'M2.5', 'M2', 'M1.5', 'M1'];
            
            allMaterials.forEach(material => {
                const basicInput = document.getElementById(`basic_${material}`);
                const dailyInput = document.getElementById(`daily_${material}`);
                
                if (basicInput && dailyInput) {
                    priceDataToSave[material] = {
                        basic: parseFloat(basicInput.value) || 0,
                        daily: parseFloat(dailyInput.value) || 0
                    };
                }
            });
            
            // localStorageì— ì €ì¥
            localStorage.setItem('systemSupportPriceData', JSON.stringify(priceDataToSave));
            alert('ë‹¨ê°€ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ë‹¨ê°€ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadPriceData() {
            const savedData = localStorage.getItem('systemSupportPriceData');
            if (!savedData) {
                alert('ì €ì¥ëœ ë‹¨ê°€ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const priceDataToLoad = JSON.parse(savedData);
            savedPriceInputs = priceDataToLoad;
            
            Object.keys(priceDataToLoad).forEach(material => {
                const basicInput = document.getElementById(`basic_${material}`);
                const dailyInput = document.getElementById(`daily_${material}`);
                
                if (basicInput && dailyInput) {
                    basicInput.value = priceDataToLoad[material].basic || '';
                    dailyInput.value = priceDataToLoad[material].daily || '';
                }
            });
            
            alert('ë‹¨ê°€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
        }
        
        // ë‹¨ê°€ ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°
        function exportPriceToExcel() {
            if (Object.keys(calculatedMaterials).length === 0) {
                alert('ë¨¼ì € ë¬¼ëŸ‰ ê³„ì‚°ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            var csvContent = '\ufeff';
            csvContent += 'ìì¬ì½”ë“œ,ìì¬ëª…,ê¸°ë³¸ë£Œ(ì›),ì¼ë‹¨ê°€(ì›)\n';
            
            for (var key in calculatedMaterials) {
                var material = calculatedMaterials[key];
                var basicInput = document.getElementById('basic_' + key);
                var dailyInput = document.getElementById('daily_' + key);
                var basic = basicInput ? basicInput.value || 0 : 0;
                var daily = dailyInput ? dailyInput.value || 0 : 0;
                
                csvContent += key + ',"' + (materialNames[key] || key) + '",' + basic + ',' + daily + '\n';
            }
            
            var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            var link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'ë™ë°”ë¦¬_ë‹¨ê°€í‘œ_' + new Date().toISOString().slice(0,10) + '.csv';
            link.click();
            
            alert('ë‹¨ê°€í‘œê°€ CSV íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }
        
        // ë‹¨ê°€ ì—‘ì…€ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function importPriceFromExcel(event) {
            var file = event.target.files[0];
            if (!file) return;
            
            var reader = new FileReader();
            reader.onload = function(e) {
                try {
                    var content = e.target.result;
                    var lines = content.split('\n');
                    var importCount = 0;
                    
                    for (var i = 1; i < lines.length; i++) {
                        var line = lines[i].trim();
                        if (!line) continue;
                        
                        var cols = line.match(/(\".*?\"|[^\",\s]+)(?=\s*,|\s*$)/g);
                        if (cols && cols.length >= 4) {
                            var key = cols[0].replace(/\"/g, '').trim();
                            var basic = parseFloat(cols[2].replace(/\"/g, '')) || 0;
                            var daily = parseFloat(cols[3].replace(/\"/g, '')) || 0;
                            
                            var basicInput = document.getElementById('basic_' + key);
                            var dailyInput = document.getElementById('daily_' + key);
                            
                            if (basicInput && dailyInput) {
                                basicInput.value = basic;
                                dailyInput.value = daily;
                                savedPriceInputs[key] = { basic: basic, daily: daily };
                                importCount++;
                            }
                        }
                    }
                    
                    if (importCount > 0) {
                        alert('ë‹¨ê°€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤. (' + importCount + 'ê°œ í•­ëª©)');
                        var container = document.getElementById('priceInputContainer');
                        if (container && container.style.display === 'none') {
                            container.style.display = 'block';
                            document.querySelector('.toggle-price-btn').textContent = 'ë‹¨ê°€ ì…ë ¥ ë‹«ê¸°';
                        }
                    } else {
                        alert('ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” ë‹¨ê°€ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    console.error(error);
                }
            };
            reader.readAsText(file, 'UTF-8');
            event.target.value = '';
        }
        
        // ë‹¤ì¤‘ êµ¬ê°„ - í˜„ì¬ êµ¬ê°„ì„ ê²¬ì  ëª©ë¡ì— ì¶”ê°€
        function addToQuotationList() {
            if (Object.keys(calculatedMaterials).length === 0) {
                alert('ë¨¼ì € ë¬¼ëŸ‰ ê³„ì‚°ì„ ì‹¤í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            var sectionName = prompt('êµ¬ê°„ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:', materialRatios[currentStructureType].name + ' êµ¬ê°„');
            if (!sectionName) return;
            
            var volume = parseFloat(document.getElementById('volume').value) || 0;
            var usageDays = parseInt(document.getElementById('usageDays').value) || 30;
            
            var section = {
                id: Date.now(),
                name: sectionName,
                structureType: currentStructureType,
                structureName: materialRatios[currentStructureType].name,
                volume: volume,
                usageDays: usageDays,
                materials: JSON.parse(JSON.stringify(calculatedMaterials)),
                prices: JSON.parse(JSON.stringify(savedPriceInputs)),
                addedAt: new Date().toLocaleString()
            };
            
            quotationSections.push(section);
            updateQuotationCount();
            updateQuotationListPreview();
            
            alert('"' + sectionName + '" êµ¬ê°„ì´ ê²¬ì  ëª©ë¡ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\ní˜„ì¬ ' + quotationSections.length + 'ê°œ êµ¬ê°„ì´ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
        }
        
        function updateQuotationCount() {
            document.getElementById('quotationCount').textContent = quotationSections.length;
        }
        
        function updateQuotationListPreview() {
            var preview = document.getElementById('quotationListPreview');
            var content = document.getElementById('quotationListContent');
            
            if (quotationSections.length === 0) {
                preview.style.display = 'none';
                return;
            }
            
            preview.style.display = 'block';
            
            var html = '<table style="width:100%;border-collapse:collapse;font-size:14px;">';
            html += '<thead><tr style="border-bottom:2px solid rgba(255,255,255,0.3);">';
            html += '<th style="padding:8px;text-align:left;">êµ¬ê°„ëª…</th>';
            html += '<th style="padding:8px;text-align:center;">êµ¬ì¡°íƒ€ì…</th>';
            html += '<th style="padding:8px;text-align:right;">ë¬¼ëŸ‰(ã¥)</th>';
            html += '<th style="padding:8px;text-align:center;">ì‚­ì œ</th>';
            html += '</tr></thead><tbody>';
            
            for (var i = 0; i < quotationSections.length; i++) {
                var section = quotationSections[i];
                html += '<tr style="border-bottom:1px solid rgba(255,255,255,0.1);">';
                html += '<td style="padding:8px;">' + section.name + '</td>';
                html += '<td style="padding:8px;text-align:center;">' + section.structureName + '</td>';
                html += '<td style="padding:8px;text-align:right;">' + section.volume.toLocaleString() + '</td>';
                html += '<td style="padding:8px;text-align:center;"><button onclick="removeQuotationSection(' + i + ')" style="background:#dc3545;color:white;border:none;padding:4px 10px;border-radius:4px;cursor:pointer;">âœ•</button></td>';
                html += '</tr>';
            }
            
            html += '</tbody></table>';
            content.innerHTML = html;
        }
        
        function removeQuotationSection(index) {
            var section = quotationSections[index];
            if (confirm('"' + section.name + '" êµ¬ê°„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                quotationSections.splice(index, 1);
                updateQuotationCount();
                updateQuotationListPreview();
            }
        }
        
        function showQuotationList() {
            if (quotationSections.length === 0) {
                alert('ì €ì¥ëœ êµ¬ê°„ì´ ì—†ìŠµë‹ˆë‹¤.\në¬¼ëŸ‰ ê³„ì‚° í›„ "í˜„ì¬ êµ¬ê°„ ê²¬ì ì— ì¶”ê°€" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
                return;
            }
            
            var message = 'ğŸ“‹ ì €ì¥ëœ êµ¬ê°„ ëª©ë¡\n========================================\n\n';
            
            for (var i = 0; i < quotationSections.length; i++) {
                var section = quotationSections[i];
                message += (i + 1) + '. ' + section.name + '\n';
                message += '   êµ¬ì¡°: ' + section.structureName + '\n';
                message += '   ë¬¼ëŸ‰: ' + section.volume.toLocaleString() + 'ã¥\n\n';
            }
            
            message += '========================================\n';
            message += 'ì´ ' + quotationSections.length + 'ê°œ êµ¬ê°„';
            
            alert(message);
        }
        
        function clearQuotationList() {
            if (quotationSections.length === 0) {
                alert('ì €ì¥ëœ êµ¬ê°„ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm('ì €ì¥ëœ ' + quotationSections.length + 'ê°œ êµ¬ê°„ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                quotationSections = [];
                updateQuotationCount();
                updateQuotationListPreview();
                alert('êµ¬ê°„ ëª©ë¡ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í†µí•© ê²¬ì ì„œ ìƒì„±
        function generateCombinedQuotation() {
            if (quotationSections.length === 0) {
                alert('ì €ì¥ëœ êµ¬ê°„ì´ ì—†ìŠµë‹ˆë‹¤.\në¬¼ëŸ‰ ê³„ì‚° í›„ "í˜„ì¬ êµ¬ê°„ ê²¬ì ì— ì¶”ê°€" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
                return;
            }
            
            var companyName = prompt('ì—…ì²´ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:', '');
            if (!companyName) return;
            
            var projectName = prompt('ê³µì‚¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:', '');
            if (!projectName) return;
            
            var today = new Date();
            var dateStr = today.getFullYear() + '. ' + String(today.getMonth()+1).padStart(2,'0') + '. ' + String(today.getDate()).padStart(2,'0');
            
            var specs = {
                'P17': '1725mm', 'P12': '1225mm', 'P08': '825mm', 'P04': '425mm', 'P02': '216mm',
                'H18': '1829mm', 'H15': '1524mm', 'H12': '1219mm', 'H09': '914mm', 'H06': '610mm', 'H03': '305mm',
                'H': '-', 'J': '-', 'S': '-', 'T': '-',
                'M3': '3000mm', 'M2.5': '2500mm', 'M2': '2000mm', 'M1.5': '1500mm', 'M1': '1000mm'
            };
            
            var materialOrder = ['P17', 'P12', 'P08', 'P04', 'P02', 'H18', 'H15', 'H12', 'H09', 'H06', 'H03', 'H', 'J', 'S', 'T', 'M3', 'M2.5', 'M2', 'M1.5', 'M1'];
            
            var grandTotal = 0;
            var totalVolume = 0;
            var sectionsHTML = '';
            
            for (var s = 0; s < quotationSections.length; s++) {
                var section = quotationSections[s];
                var usageDays = section.usageDays || 30;
                var sectionTotal = 0;
                var itemsHTML = '';
                
                totalVolume += section.volume;
                
                for (var m = 0; m < materialOrder.length; m++) {
                    var key = materialOrder[m];
                    if (section.materials[key] && section.materials[key].quantity > 0) {
                        var material = section.materials[key];
                        var qty = material.quantity;
                        var price = section.prices[key] || { basic: 0, daily: 0 };
                        var unitPrice = price.basic + (price.daily * usageDays);
                        var amount = unitPrice * qty;
                        sectionTotal += amount;
                        
                        itemsHTML += '<tr><td>' + (materialNames[key] || key) + '</td><td>' + (specs[key] || key) + '</td><td>EA</td>' +
                            '<td class="num">' + qty.toLocaleString() + '</td><td>' + usageDays + '</td>' +
                            '<td class="num">' + unitPrice.toLocaleString() + '</td><td class="num">' + amount.toLocaleString() + '</td></tr>';
                    }
                }
                
                grandTotal += sectionTotal;
                var pricePerM3 = section.volume > 0 ? Math.round(sectionTotal / section.volume) : 0;
                
                sectionsHTML += '<div class="section-block">' +
                    '<div class="section-header">ğŸ“ ' + section.name + ' (' + section.structureName + ' / ' + section.volume.toLocaleString() + 'ã¥)</div>' +
                    '<table><thead><tr><th style="width:18%">í’ˆëª…</th><th style="width:14%">ê·œê²©</th><th style="width:8%">ë‹¨ìœ„</th>' +
                    '<th style="width:12%">ìˆ˜ëŸ‰</th><th style="width:10%">ì¼ìˆ˜</th><th style="width:14%">ë‹¨ê°€</th><th style="width:18%">ê¸ˆì•¡</th></tr></thead>' +
                    '<tbody>' + itemsHTML + '</tbody>' +
                    '<tfoot><tr class="subtotal-row"><td colspan="6">ì†Œê³„ (ã¥ë‹¹ ' + pricePerM3.toLocaleString() + 'ì›)</td>' +
                    '<td class="num">â‚© ' + sectionTotal.toLocaleString() + '</td></tr></tfoot></table></div>';
            }
            
            var totalPricePerM3 = totalVolume > 0 ? Math.round(grandTotal / totalVolume) : 0;
            
            var quotationHTML = '<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><title>í†µí•©ê²¬ì ì„œ</title>' +
                '<style>@page{size:A4;margin:10mm 15mm}@media print{body{-webkit-print-color-adjust:exact}.section-block{page-break-inside:avoid}}' +
                '*{margin:0;padding:0;box-sizing:border-box}body{font-family:"Malgun Gothic",sans-serif;font-size:10px;line-height:1.3;color:#000;background:#fff}' +
                '.container{max-width:210mm;margin:0 auto;padding:15px 20px}' +
                '.title{text-align:center;font-size:26px;font-weight:bold;letter-spacing:15px;margin-bottom:20px;padding-bottom:12px;border-bottom:2px solid #000}' +
                '.header-info{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px}' +
                '.company-name{font-size:16px;font-weight:bold;margin-bottom:5px}' +
                '.amount-box{text-align:right}.amount-label{font-size:11px;color:#666}.amount-value{font-size:22px;font-weight:bold}' +
                '.project-name{background:#f5f5f5;padding:8px 12px;margin-bottom:12px;font-size:12px}' +
                '.summary-info{display:flex;gap:20px;margin-bottom:15px;font-size:11px}.summary-info span{background:#e8e8e8;padding:5px 12px;border-radius:3px}' +
                '.section-block{margin-bottom:15px}.section-header{background:#2a5298;color:white;padding:8px 12px;font-size:12px;font-weight:bold}' +
                'table{width:100%;border-collapse:collapse;font-size:10px}' +
                'th{background:#e8e8e8;border:1px solid #999;padding:6px 4px;font-weight:bold;text-align:center}' +
                'td{border:1px solid #ccc;padding:5px 4px;text-align:center}td.num{text-align:right;padding-right:6px}' +
                '.subtotal-row{background:#f0f0f0;font-weight:bold}.subtotal-row td{border:1px solid #999}' +
                '.grand-total{background:#1e3c72;color:white;padding:12px 15px;margin-top:15px;display:flex;justify-content:space-between;align-items:center;font-size:14px}' +
                '.grand-total .amount{font-size:20px;font-weight:bold}' +
                '.notes{background:#fafafa;border:1px solid #ddd;padding:10px 12px;margin-top:12px;font-size:10px}' +
                '.notes h4{font-size:11px;margin-bottom:6px}.notes ul{margin:0;padding-left:15px}.notes li{margin:2px 0}' +
                '.footer{margin-top:15px;text-align:right;font-size:11px}.footer p{margin:2px 0}.company-stamp{font-size:14px;font-weight:bold;margin-top:10px}' +
                '</style></head><body><div class="container">' +
                '<h1 class="title">ê²¬ ì  ì„œ</h1>' +
                '<div class="header-info"><div><div class="company-name">' + companyName + ' ê·€í•˜</div></div>' +
                '<div class="amount-box"><div class="amount-label">ê¸ˆ ì•¡</div><div class="amount-value">â‚© ' + grandTotal.toLocaleString() + '</div></div></div>' +
                '<div class="project-name"><strong>ê³µì‚¬ëª…:</strong> ' + projectName + ' (ì‹œìŠ¤í…œë™ë°”ë¦¬)</div>' +
                '<div class="summary-info"><span>ì´ ë¬¼ëŸ‰: ' + totalVolume.toLocaleString() + 'ã¥</span><span>êµ¬ê°„ ìˆ˜: ' + quotationSections.length + 'ê°œ</span><span>ã¥ë‹¹ í‰ê· ë‹¨ê°€: ' + totalPricePerM3.toLocaleString() + 'ì›</span></div>' +
                sectionsHTML +
                '<div class="grand-total"><span>í•©ê³„ (VAT ë³„ë„)</span><span class="amount">â‚© ' + grandTotal.toLocaleString() + '</span></div>' +
                '<div class="notes"><h4>[ ë¹„ê³  ]</h4><ul>' +
                '<li>ë¶€ê°€ì„¸ ë³„ë„</li>' +
                '<li>ìì¬ëŠ” ì¼ë‹¨ê°€ ì²­êµ¬ì¡°ê±´ì´ë©°, ì‹œí—˜ì— í•„ìš”í•œ ìì¬ë¹„ ë° ê²½ë¹„ ë³„ë„ ì¡°ê±´</li>' +
                '<li>ì´ ë¬¼ëŸ‰: ' + totalVolume.toLocaleString() + 'ã¥ / ã¥ë‹¹ í‰ê· ë‹¨ê°€: ' + totalPricePerM3.toLocaleString() + 'ì›</li>' +
                '<li>ë¬¼ëŸ‰ì€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë©°, ì‹¤ì œ ì„¤ì¹˜ ë¬¼ëŸ‰ìœ¼ë¡œ ì •ì‚° ì¡°ê±´</li>' +
                '<li>ìš´ë°˜ë¹„ í¸ë„ ì¡°ê±´ì´ë©°, 11í†¤ ë¯¸ë§Œ ì¶œê³ ì‹œ ì²­êµ¬ì¡°ê±´</li>' +
                '</ul></div>' +
                '<div class="footer"><p>' + dateStr + '</p><p class="company-stamp">ê°€ì„¤íŒŒíŠ¸ë„ˆ</p><p>ğŸ“ 010-7970-2108 | âœ‰ï¸ fc112@naver.com</p></div>' +
                '</div><script>window.onload=function(){window.print();}<\/script></body></html>';
            
            var printWindow = window.open('', '_blank');
            printWindow.document.write(quotationHTML);
            printWindow.document.close();
        }
        
        // í˜„ì¬ ê³„ì‚° ê²°ê³¼ ì €ì¥
        function saveCurrentCalculation() {
            const currentData = {
                id: Date.now(),
                date: new Date().toLocaleString(),
                structure: materialRatios[currentStructureType].name,
                volume: parseFloat(document.getElementById('volume').value),
                height: parseFloat(document.getElementById('height').value),
                slabThk: parseFloat(document.getElementById('slabThk').value),
                beamThk: parseFloat(document.getElementById('beamThk').value),
                materials: calculatedMaterials,
                priceData: priceData,
                usageDays: parseInt(document.getElementById('usageDays').value) || 30
            };
            
            savedCalculations.push(currentData);
            updateSavedDataList();
            
            // ë°ì´í„° ì·¨í•© ì„¹ì…˜ í‘œì‹œ
            document.getElementById('combineSection').style.display = 'block';
        }
        
        // ì €ì¥ëœ ë°ì´í„° ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateSavedDataList() {
            const listContainer = document.getElementById('savedDataList');
            listContainer.innerHTML = '';
            
            savedCalculations.forEach((data, index) => {
                const item = document.createElement('div');
                item.className = 'saved-data-item';
                item.onclick = () => toggleDataSelection(index);
                
                let totalQuantity = 0;
                Object.values(data.materials).forEach(mat => {
                    totalQuantity += mat.quantity;
                });
                
                item.innerHTML = `
                    <h4>${data.structure}</h4>
                    <p>ê³µë£¨ë² : ${data.volume}ã¥ | ì¸µê³ : ${data.height}mm</p>
                    <p>ì´ ìì¬ìˆ˜: ${totalQuantity.toLocaleString()}ê°œ</p>
                    <p>ì €ì¥ì¼ì‹œ: ${data.date}</p>
                `;
                
                listContainer.appendChild(item);
            });
        }
        
        // ë°ì´í„° ì„ íƒ í† ê¸€
        function toggleDataSelection(index) {
            const items = document.querySelectorAll('.saved-data-item');
            const selectedIndex = selectedDataIndices.indexOf(index);
            
            if (selectedIndex > -1) {
                selectedDataIndices.splice(selectedIndex, 1);
                items[index].classList.remove('selected');
            } else {
                selectedDataIndices.push(index);
                items[index].classList.add('selected');
            }
        }
        
        // ë°ì´í„° ì·¨í•©
        function combineData() {
            if (selectedDataIndices.length < 2) {
                alert('ì·¨í•©í•  ë°ì´í„°ë¥¼ 2ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì·¨í•©ëœ ë°ì´í„° ìƒì„±
            const combinedMaterials = {};
            const combinedStructures = [];
            let totalVolume = 0;
            
            selectedDataIndices.forEach(index => {
                const data = savedCalculations[index];
                combinedStructures.push(data.structure);
                totalVolume += data.volume;
                
                // ìì¬ ìˆ˜ëŸ‰ í•©ì‚°
                Object.keys(data.materials).forEach(material => {
                    if (!combinedMaterials[material]) {
                        combinedMaterials[material] = {
                            quantity: 0,
                            weight: 0,
                            unitWeight: data.materials[material].unitWeight
                        };
                    }
                    combinedMaterials[material].quantity += data.materials[material].quantity;
                    combinedMaterials[material].weight += data.materials[material].weight;
                });
            });
            
            // ì·¨í•© ê²°ê³¼ í‘œì‹œ
            displayCombinedResults(combinedMaterials, combinedStructures, totalVolume);
        }
        
        // ì·¨í•© ê²°ê³¼ í‘œì‹œ
        function displayCombinedResults(materials, structures, totalVolume) {
            // ìƒˆë¡œìš´ ëª¨ë‹¬ ì°½ìœ¼ë¡œ í‘œì‹œ
            let modalHTML = '<h3>ğŸ“Š ì·¨í•© ê²°ê³¼</h3>';
            modalHTML += `<p style="margin-bottom: 20px;">ì·¨í•© êµ¬ì¡°: ${structures.join(' + ')}</p>`;
            modalHTML += `<p style="margin-bottom: 20px;">ì´ ê³µë£¨ë² : ${totalVolume}ã¥</p>`;
            
            modalHTML += '<table class="detail-table">';
            modalHTML += '<thead><tr><th>í’ˆëª…</th><th>ê·œê²©</th><th>ì´ìˆ˜ëŸ‰</th><th>ë‹¨ìœ„ì¤‘ëŸ‰(kg)</th><th>ì´ì¤‘ëŸ‰(kg)</th></tr></thead>';
            modalHTML += '<tbody>';
            
            const categories = [
                { title: 'ìˆ˜ì§ì¬', items: ['P17', 'P12', 'P08', 'P04', 'P02'] },
                { title: 'ìˆ˜í‰ì¬', items: ['H18', 'H15', 'H12', 'H09', 'H06', 'H03'] },
                { title: 'ë¶€ì†ìì¬', items: ['H', 'J', 'S', 'T'] },
                { title: 'ë©ì—ì¬', items: ['M3', 'M2.5', 'M2', 'M1.5', 'M1'] }
            ];
            
            let totalWeight = 0;
            
            categories.forEach(category => {
                let categoryHasItems = false;
                category.items.forEach(item => {
                    if (materials[item] && materials[item].quantity > 0) {
                        categoryHasItems = true;
                    }
                });
                
                if (categoryHasItems) {
                    modalHTML += `<tr><td colspan="5" style="background: #e8f0ff; font-weight: bold; color: #1e3c72;">${category.title}</td></tr>`;
                    
                    category.items.forEach(item => {
                        if (materials[item] && materials[item].quantity > 0) {
                            totalWeight += materials[item].weight;
                            modalHTML += `
                                <tr>
                                    <td>${materialNames[item]}</td>
                                    <td>${item}</td>
                                    <td style="text-align: right;">${materials[item].quantity.toLocaleString()}</td>
                                    <td style="text-align: right;">${materials[item].unitWeight.toFixed(1)}</td>
                                    <td style="text-align: right;">${materials[item].weight.toFixed(0).toLocaleString()}</td>
                                </tr>
                            `;
                        }
                    });
                }
            });
            
            modalHTML += `<tr style="font-weight: bold; background: #2a5298; color: white;">
                <td colspan="2">í•©ê³„</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">-</td>
                <td style="text-align: right;">${totalWeight.toFixed(0).toLocaleString()}</td>
            </tr>`;
            
            modalHTML += '</tbody></table>';
            
            modalHTML += '<div class="button-group" style="margin-top: 20px;">';
            modalHTML += '<button class="button button-success" onclick="exportCombinedToExcel()">ì—‘ì…€ ë‚´ë³´ë‚´ê¸°</button>';
            modalHTML += '</div>';
            
            // ëª¨ë‹¬ í‘œì‹œ
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 800px;">
                    <button class="close-modal" onclick="this.parentElement.parentElement.remove()">Ã—</button>
                    ${modalHTML}
                </div>
            `;
            document.body.appendChild(modal);
            
            // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥ (ì—‘ì…€ ë‚´ë³´ë‚´ê¸°ìš©)
            window.combinedExportData = {
                materials,
                structures,
                totalVolume,
                totalWeight
            };
        }
        
        // ë””ë²„ê·¸ ëª¨ë“œ í† ê¸€
        function toggleDebug() {
            // ë””ë²„ê·¸ ê¸°ëŠ¥ ì œê±°ë¨
        }
        
        // ë¹„ìœ¨í‘œ ë³´ê¸°
        function showRatioTable() {
            // ë¹„ìœ¨í‘œ ê¸°ëŠ¥ ì œê±°ë¨
        }
        
        // ì—‘ì…€ ë‚´ë³´ë‚´ê¸°
        function exportToExcel() {
            const structureName = materialRatios[currentStructureType].name;
            const volume = document.getElementById('volume').value;
            const usageDays = document.getElementById('usageDays').value;
            const showPrice = Object.keys(priceData).length > 0;
            
            // CSV í—¤ë”
            let csv = '\ufeff'; // BOM for UTF-8
            csv += 'ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ì‚°ì¶œì„œ\n';
            csv += `êµ¬ì¡° íƒ€ì…:,${structureName}\n`;
            csv += `ì„¤ì¹˜ ë¬¼ëŸ‰:,${volume}ã¥\n`;
            
            if (showPrice) {
                csv += `ì‚¬ìš© ì¼ìˆ˜:,${usageDays}ì¼\n`;
            }
            
            csv += `ì‘ì„±ì¼:,${new Date().toLocaleDateString()}\n\n`;
            
            if (showPrice) {
                csv += 'í’ˆëª…,ê·œê²©,ìˆ˜ëŸ‰,ë‹¨ìœ„ì¤‘ëŸ‰(kg),ì´ì¤‘ëŸ‰(kg),ê¸°ë³¸ë£Œ(ì›),ì¼ë‹¨ê°€(ì›),ì´ê¸ˆì•¡(ì›)\n';
            } else {
                csv += 'í’ˆëª…,ê·œê²©,ìˆ˜ëŸ‰,ë‹¨ìœ„ì¤‘ëŸ‰(kg),ì´ì¤‘ëŸ‰(kg)\n';
            }
            
            // í…Œì´ë¸” ë°ì´í„°
            const rows = document.querySelectorAll('#detailTableBody tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const rowData = Array.from(cells).map(cell => cell.textContent);
                csv += rowData.join(',') + '\n';
            });
            
            // ë‹¤ìš´ë¡œë“œ
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ì‹œìŠ¤í…œë™ë°”ë¦¬_ë¬¼ëŸ‰ì‚°ì¶œ_${structureName}_${new Date().toISOString().slice(0,10)}.csv`;
            link.click();
        }
        
        // ì´ˆê¸°í™”
        function resetCalculator() {
            document.getElementById('volume').value = '100';
            document.getElementById('height').value = '5000';
            document.getElementById('slabThk').value = '200';
            document.getElementById('beamThk').value = '0';
            document.getElementById('safetyRate').value = '0';
            document.getElementById('safetyRateDisplay').textContent = '0';
            document.getElementById('usageDays').value = '30';
            
            // êµ¬ì¡° íƒ€ì… ì´ˆê¸°í™”
            currentStructureType = 'wall';
            document.querySelectorAll('.structure-type-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector('.structure-type-card').classList.add('active');
            
            // ê²°ê³¼ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('resultSection').style.display = 'none';
            
            // ë‹¨ê°€ ë°ì´í„° ì´ˆê¸°í™”
            priceData = {};
            calculatedMaterials = {};
            savedCalculations = [];
            selectedDataIndices = [];
            
            // ë‹¨ê°€ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('priceInputContainer').style.display = 'none';
            document.querySelector('.toggle-price-btn').textContent = 'ë‹¨ê°€ ì…ë ¥';
            
            // ë°ì´í„° ì·¨í•© ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('combineSection').style.display = 'none';
            
            // ê¸ˆì•¡ ì—´ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.price-column').forEach(col => {
                col.style.display = 'none';
            });
            
            document.querySelectorAll('.price-summary').forEach(elem => {
                elem.style.display = 'none';
            });
            
            // ìŠ¤í¬ë¡¤ ë§¨ ìœ„ë¡œ
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // ìš°í´ë¦­ ë°©ì§€
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            alert('Â© 2025 ê°€ì„¤íŒŒíŠ¸ë„ˆ\në³¸ í”„ë¡œê·¸ë¨ì˜ ì €ì‘ê¶Œì€ ë³´í˜¸ë©ë‹ˆë‹¤.');
            return false;
        });
        
        // ê°œë°œì ë„êµ¬ ë°©ì§€
        document.addEventListener('keydown', function(e) {
            // F12
            if (e.key === 'F12') {
                e.preventDefault();
                alert('ê°œë°œì ë„êµ¬ ì‚¬ìš©ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
                return false;
            }
            // Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C
            if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) {
                e.preventDefault();
                alert('ê°œë°œì ë„êµ¬ ì‚¬ìš©ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
                return false;
            }
            // Ctrl+U (ì†ŒìŠ¤ë³´ê¸°)
            if (e.ctrlKey && e.key === 'u') {
                e.preventDefault();
                alert('ì†ŒìŠ¤ ì½”ë“œ ë³´ê¸°ê°€ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
                return false;
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ì—”í„°í‚¤ë¡œ ê³„ì‚° ì‹¤í–‰
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && e.target.tagName === 'INPUT') {
                    calculateQuantity();
                }
            });
            
            // íƒ€ì´í‹€ ë³´í˜¸
            const originalTitle = 'ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ë¬¼ëŸ‰ ê³„ì‚°ê¸° v1.0 - ê°€ì„¤íŒŒíŠ¸ë„ˆ';
            setInterval(() => {
                if (document.title !== originalTitle) {
                    document.title = originalTitle;
                }
            }, 100);
            
            // íŒŒì¼ëª… ë³€ê²½ ê²½ê³ 
            if (window.location.pathname) {
                const fileName = window.location.pathname.split('/').pop();
                const expectedFileName = 'ì‹œìŠ¤í…œ ë™ë°”ë¦¬ ê³„ì‚°ê¸°.html';
                
                if (fileName && decodeURIComponent(fileName) !== expectedFileName && fileName !== '') {
                    console.warn(`âš ï¸ ê²½ê³ : íŒŒ